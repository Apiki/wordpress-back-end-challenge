const bodyClass=document.querySelector("body").classList,is_single=bodyClass.contains("single-post"),is_page_favicon=bodyClass.contains("page-template-page-favicons");function add(e,t,o){if(!o)return;if(!t||"number"!=typeof t)return;if(!e||"number"!=typeof e)return;let n=new FormData;n.append("user",e),n.append("post",t);fetch(o+"/add_favicon",{method:"POST",body:n}).then(e=>e.json()).then(e=>{console.log({result:e}),toggleLoadSingle(),document.querySelector(".favicon-action__rmm").classList.remove("hide")}).catch(e=>console.log("error",e))}function remove(e,t,o){if(!o)return;if(!t||"number"!=typeof t)return;if(!e||"number"!=typeof e)return;let n=new FormData;n.append("user",e),n.append("post",t);fetch(o+"/rm_favicon",{method:"POST",body:n}).then(e=>e.json()).then(e=>{console.log(e),is_page_favicon&&document.getElementById("favorito-"+t).remove(),is_single&&(toggleLoadSingle(),document.querySelector(".favicon-action__add").classList.remove("hide"))}).catch(e=>console.log("error",e))}function checkPostFavorite(e,t,o){o&&t&&"number"==typeof t&&e&&"number"==typeof e&&fetch(`${o}/check_post_favicon/?post=${t}&user=${e}`).then(e=>e.json()).then(e=>{createButtonFavorite(e.favorite)}).catch(e=>console.log("error",e))}function createButtonFavorite(e){let t=document.createElement("div");t.classList.add("favicon-action");let o=document.createElement("button");o.innerHTML="Favoritar Post",o.classList.add("favicon-action__add"),e&&o.classList.add("hide");let n=document.createElement("button");n.innerHTML="Remover dos Favoritos",n.classList.add("favicon-action__rmm"),e||n.classList.add("hide");let a=document.createElement("span");a.innerHTML="Aguarde...",a.classList.add("favicon-action__loading"),a.classList.add("hide"),t.append(o),t.append(n),t.append(a),document.querySelector("body").append(t)}function toggleLoadSingle(){document.querySelector(".favicon-action__loading").classList.toggle("hide")}document.addEventListener("DOMContentLoaded",()=>{if(favicon_plugin_obj){const{base_url_req:e}=favicon_plugin_obj;if(is_single){const{user_id:t,post_id:o}=favicon_plugin_obj;checkPostFavorite(t,o,e),document.addEventListener("click",n=>{const a=n.target.classList.contains("favicon-action__add"),i=n.target.classList.contains("favicon-action__rmm");(a||i)&&(n.target.classList.add("hide"),toggleLoadSingle(),i&&remove(t,o,e),a&&add(t,o,e))})}if(is_page_favicon){const t=document.querySelectorAll(".card-post__remove");t&&t.forEach(t=>{t.addEventListener("click",t=>{const{currentTarget:o}=t,n=+o.dataset.id,{user_id:a}=favicon_plugin_obj;o.disabled=!0,o.querySelector(".-is-text").classList.toggle("hide-span"),o.querySelector(".-is-load").classList.toggle("hide-span"),remove(a,n,e)})})}}});